<div class="nested_comment">
  <% @article.comments.each_with_index do |comm, index| %>
    <p id="nested_<%= index %>"><%= comm.body %></p>
      <div id="comm_child_<%= index %>"></div>

      <script>
        $(function(){
           var fireFloodlight = function()
            {
              if (true)
              {$("#comm_child_<%= index %>").append('<form class="new_comment" id="new_comment" action="/comments/<%= comm.id %>/comments" accept-charset="UTF-8" method="POST">' +
                        '<input name="utf8" type="hidden" value="&#x2713;"/>' + '<input name="article_id" type="hidden" value="<%= Article.find()%>"/>' + '<%= hidden_field_tag :authenticity_token, form_authenticity_token -%>'+
                        '<textarea name="comment[body]" id="comment_body"></textarea>' +
                        '<br><input type="submit" name="commit" value="Create Comment"/>' +
                        '</form>' +'<br>');
                 }
              else{alert("mehta");}};
              $('#nested_<%=index%>').click(fireFloodlight);
          });
     </script>

      <% comm.comments.each do |child|  %>
          <div class="comment_child">
            <%= child.body if child%>
          </div>
      <% end %>
  <% end %>
</div>
